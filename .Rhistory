wifidf$sentw <- (wifidf$npos - wifidf$nneg)/wifidf$ntok
hist(wifidf$sentw, breaks = 100)
ggplot(wifidf, aes(attributes.wifi, sentw))+geom_boxplot(fill="light blue") + labs(x="WIFI status provided by yelp", y="sentiment about wifi")
mywc <- function(doclist){
freqdf<-as.data.frame(table(unlist(doclist)),stringsAsFactors=F)
wordcloud(freqdf$Var1, freqdf$Freq, max.words=50, colors=brewer.pal(8, "Dark2"))
}
freep <- filter(wifidf[,-5], sentw > 0, attributes.wifi == "free")$wifi_sen
freen <- filter(wifidf[,-5], sentw < 0, attributes.wifi == "free")$wifi_sen
paidp <- filter(wifidf[,-5], sentw > 0, attributes.wifi == "paid")$wifi_sen
paidn <- filter(wifidf[,-5], sentw < 0, attributes.wifi == "paid")$wifi_sen
nop <- filter(wifidf[,-5], sentw > 0, attributes.wifi == "no")$wifi_sen
non <- filter(wifidf[,-5], sentw < 0, attributes.wifi == "no")$wifi_sen
wordcloud(freep, max.words = 50, colors = brewer.pal(8,"Dark2"))
wordcloud(freen, max.words = 50, colors = brewer.pal(8,"Dark2"))
wordcloud(paidp, max.words = 50, colors = brewer.pal(8,"Dark2"))
wordcloud(paidn, max.words = 100, colors = brewer.pal(8,"Dark2"))
wordcloud(nop, max.words = 50, colors = brewer.pal(8,"Dark2"))
wordcloud(non, max.words = 50, colors = brewer.pal(8,"Dark2"))
?wordcloud
wordcloud(freep, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(freen, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(paidp, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(paidn, max.words = 100, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(nop, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(non, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(freep, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(freen, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(paidp, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(paidn, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(nop, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wordcloud(non, max.words = 50, colors = brewer.pal(8,"Dark2"), min.freq = 0)
wifidf4<-readRDS("wifidf4.rds")
names(wifidf5)
wifidf5 <- wifidf4[, -c(1,2,4,5,40,41)]
wifidf5 <- wifidf5[complete.cases(wifidf5),]
names(wifidf5)
wifidf7 <- mutate(group_by(wifidf4, business_id), ave_star = mean(stars), ave_sent = mean(sentiment), ave_sentw = mean(sentw), nrev = n())
wifidf7 <- wifidf7[,-c(2,3,4,5,40:49)]
wifidf7 <- wifidf7[complete.cases(wifidf7),]
wifidf8 <- wifidf7[!duplicated(wifidf7), ]
wifidf8 <- wifidf8[, -1]
f2 <- lm(ave_star~., data=wifidf8, weights = sqrt(nrev))
summary(f2)
f21 <- lm(ave_star~ave_sent + ave_sentw, data=wifidf8, weights = sqrt(nrev))
summary(f21)
f22 <- step(f21, scope = list(lower=f21, upper=f2), direction="forward", steps=50)
summary(f22)
confint(f22, "sentw")
confint(f22, "ave_sentw")
names(wifidf6)
wifidf6 <- wifidf5[,-c(36:41)]
names(wifidf6)
f22 <- step(f21, scope = list(lower=f21, upper=f2), direction="forward", steps=10, trace = FALSE)
suppressWarnings(library(dplyr))
suppressWarnings(library(ggplot2))
suppressWarnings(library(gplots))
# suppressWarnings(library(RColorBrewer))
suppressWarnings(library(lsr))
setwd("/home/li/Dropbox/jiaqi")
raw <- read.csv("Dissertation_Survey.csv", stringsAsFactors=FALSE)
df <- raw[, c(12,13,14,15,16,17, 43:46,47, 65:74)]
names(df) <- c("gender", "age", "degree", "stay","marital","religion", "sla1", "sla2", "sla3", "sla4", "sla_id", "y1", "y2", "y3", "y4", "y5", "y6", "y7", "y8", "y9", "y10")
df$age
df$age[df$age=="adult"] <- "25"
df$age[df$age==" "] <- NA
df$age <- as.numeric(df$age)
df$age[df$age==3] <- 30
df$stay
wlidx <- df$stay=="Whole Life"
df$stay[df$stay == " "] <- NA
df$stay<- gsub("months?", "", df$stay)
df$stay[(!grepl("[0-9]", df$stay))&!is.na(df$stay)] <- "0"
for(i in seq(df$stay)){
if(grepl(" *([0-9]+) ?ye?a?rs?.*", df$stay[i])){
df$stay[i] <-gsub(" *([0-9]+) ?ye?a?rs?.*", "\\1", df$stay[i])
df$stay[i] <-as.character(as.numeric(df$stay[i])*12)
}
}
df$stay <- as.numeric(gsub(" ", "", df$stay))
# The value "whole life" is change to the person's age times 12
df$stay[wlidx] <- df$age[wlidx] * 12
df$SLval <- rep(0, nrow(df))
for(i in 1:nrow(df)){
if(is.na(df[i,7])|is.na(df[i,8])){df$SLval[i] <- NA;next}
if(df[i,7] <= 2){
if(df[i,8] <= 2){df$SLval[i] <- "N"}
else if(df[i, 8] ==3){df$SLval[i] <- "(W)"}
else if(df[i, 8] > 3){df$SLval[i] <- "W"}
}
else if(df[i,7] == 3){
if(df[i,8] <= 2){df$SLval[i] <- "(A)"}
else if(df[i, 8] ==3){df$SLval[i] <- "(B)"}
else if(df[i, 8] > 3){df$SLval[i] <- "W"}
}
else{
if(df[i,8] <= 3){df$SLval[i] <- "A"}
else{df$SLval[i] <- "B"}
}
}
### If you only want 4 groups with no "()"
df$SLval4 <- gsub("[()]", "", df$SLval)
table(df$SLval4)
df$SLcom <- rep(0, nrow(df))
for(i in 1:nrow(df)){
if(is.na(df[i,9])|is.na(df[i,10])){df$SLcom[i] <- NA;next}
if(df[i,9] <= 2){
if(df[i,10] <= 2){df$SLcom[i] <- "N"}
else if(df[i, 10] ==3){df$SLcom[i] <- "(W)"}
else if(df[i, 10] > 3){df$SLcom[i] <- "W"}
}
else if(df[i,9] == 3){
if(df[i,10] <= 2){df$SLcom[i] <- "(A)"}
else if(df[i, 10] ==3){df$SLcom[i] <- "(B)"}
else if(df[i, 10] > 3){df$SLcom[i] <- "W"}
}
else{
if(df[i,10] <= 3){df$SLcom[i] <- "A"}
else{df$SLcom[i] <- "B"}
}
}
### If you only want 4 groups with no "()"
df$SLcom4 <- gsub("[()]", "", df$SLcom)
table(df$SLcom4)
table(df[,c(23,25)])
df$sla_id[df$sla_id==2&!is.na(df$sla_id)] <- 9
# re-order the factors
df$sla_id <- factor(as.factor(df$sla_id), levels=c("1", "7", "10", "9", "5"))
df$sla_id <- as.numeric(df$sla_id)
df$y2 <- 5-df$y2
df$y4 <- 5-df$y4
df$y8 <- 5-df$y8
df$y9 <- 5-df$y9
df$y10 <- 5-df$y10
df$y <- rowSums(df[,12:21])
hist(df$y, breaks=15, col="light blue", xlab ="scores of attitude seeking professional help")
summary(df$y)
### Based on 7 groups
x <- data.frame(val=factor(df$SLval, levels=c("A", "(A)", "N", "B", "(B)", "(W)", "W")), com=factor(df$SLcom, levels=c("A", "(A)", "N", "B", "(B)", "(W)", "W")), id = df$sla_id)
x2<-x[complete.cases(x),]
ggplot(data = x2, aes(x = val, y = com, colour=id)) + stat_sum(aes(size = factor(..n..)), geom = "point") + scale_size_discrete(range = c(3, 20)) + labs(title="3 ACCULTURATION SCORES based on 7 groupss", x="SL-ASIA values score", y="SL-ASIA behavioral competencies score", colour = "SL-ASIA self-identity score", size="number of individual")
### Based on 4 groups
x <- data.frame(val=factor(df$SLval4, levels=c("A", "N", "B", "W")), com=factor(df$SLcom4, levels=c("A", "N", "B", "W")), id = df$sla_id)
x2<-x[complete.cases(x),]
ggplot(data = x2, aes(x = val, y = com, colour=id)) + stat_sum(aes(size = factor(..n..)), geom = "point") + scale_size_discrete(range = c(3, 20))+ labs(title="3 ACCULTURATION SCORES based on 7 groupss", x="SL-ASIA values score", y="SL-ASIA behavioral competencies score", colour = "SL-ASIA self-identity score", size="number of individual")
x <- data.frame(val=factor(df$SLval4, levels=c("A", "N", "B", "W")), com=factor(df$SLcom4, levels=c("A", "N", "B", "W")), id = df$sla_id, y=df$y)
x2<-x[complete.cases(x),]
# The relationship between our acculturation scores and our response
ggplot(aes(x=val, y=y, fill=val), data=x2) + geom_boxplot(outlier.colour = "red", outlier.size = 5)
ggplot(aes(x=com, y=y, fill=com), data=x2) + geom_boxplot(outlier.colour = "red", outlier.size = 5)
ggplot(aes(x=as.numeric(id), y=y, colour=id), data=x2) + stat_sum(aes(size = factor(..n..)), geom="point", alpha=0.8) + scale_size_discrete(range = c(5,20))
# Overall plot
forplotly <- x2
forplotly <- summarise(group_by(x2, val, com, id), number = n(), y = mean(y))
df2 <- df[,c(26, 1:6, 23,25, 11)]
df4<-df2[complete.cases(df2),]
sapply(df4, class)
#gender
df4$gender[df4$gender==1] <- "man"
df4$gender[df4$gender==2] <- "woman"
df4$gender <- factor(df4$gender, levels=c("man", "woman"))
#degree
df4$degree[df4$degree == 1] <- "undergraduate"
df4$degree[df4$degree == 2] <- "master"
df4$degree[df4$degree == 3] <- "doctoral"
df4$degree <- factor(df4$degree, levels = c("undergraduate", "master", "doctoral"))
#marital
df4$marital[df4$marital==1] <- "single"
df4$marital[df4$marital==2] <- "married"
df4$marital <- factor(df4$marital, levels=c("single", "married"))
#religion
df4$religion[df4$religion==1] <- "christian"
df4$religion[df4$religion==2] <- "atheist"
df4$religion[df4$religion==3] <- "Buddhist"
df4$religion <- factor(df4$religion, levels=c("atheist", "christian", "Buddhist"))
#SLval4
df4$SLval4 <- factor(df4$SLval4, levels = c("A","N","B","W"))
#SLcom4
df4$SLcom4 <- factor(df4$SLcom4, levels = c("A","N","B","W"))
panel.hist <- function(x, ...)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(usr[1:2], 0, 1.5) )
h <- hist(x, plot = FALSE)
breaks <- h$breaks; nB <- length(breaks)
y <- h$counts; y <- y/max(y)
rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
}
panel.cor <- function(x, y, digits = 2, prefix = "", cex.cor, ...)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste0(prefix, txt)
if(missing(cex.cor)) cex.cor <- 1/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r+1)
}
pairs(df4, panel=panel.smooth, diag.panel = panel.hist, lower.panel = panel.cor)
par(mfrow=c(2,2))
hist(df4$age)
hist(df4$stay)
hist(log(df4$age))
hist(df4$stay^(1/3))
df5 <- mutate(df4, stay=stay^(1/3), age=log(age))
pairs(df5, panel=panel.smooth, diag.panel = panel.hist, lower.panel = panel.cor)
corr<-df4[1:10,];corr[,]<-0
corr <- as.matrix(corr)
diag(corr) <- 1
rownames(corr) <- colnames(corr)
N <- nrow(df4)
for(i in 1:(ncol(df4)-1)){
for(j in (i+1):ncol(df4)){
type <- (class(df4[,i])=="numeric") + (class(df4[,j])=="numeric")
if(type==0){
corr[i,j] <- cramersV(df4[,i], df4[,j])
}
else if(type==1){
if(class(df4[,i])=="numeric"){
sumsq <- summary(aov(df4[,i]~df4[,j]))[[1]][,2]
corr[i,j] <- sqrt(sumsq[1]/(sumsq[1]+sumsq[2]))
}
else{
sumsq <- summary(aov(df4[,j]~df4[,i]))[[1]][,2]
corr[i,j] <- sqrt(sumsq[1]/(sumsq[1]+sumsq[2]))
}
}
else{
corr[i,j] <- abs(cor(df4[,i], df4[,j]))
}
}
}
corr[lower.tri(corr)] <- NA
rownames(corr) <- colnames(corr)
corr_palette <- colorRampPalette(c("black", "red"))(n = 1000)
heatmap.2(corr, Rowv=NA, Colv=NA, scale = "none", col=corr_palette, dendrogram="none", trace="none", key=F, margins = c(5, 12))
fm <- lm(y~., df4)
summary(fm)
fmstep <- step(fm)
summary(fmstep)
fmint <- lm(y~.*., df4)
summary(fmint)
fmintstep <- step(fmint)
summary(fmintstep)
genderm <- lm(y~gender*., df4)
agem <- lm(y~age*., df4)
degreem <- lm(y~degree*., df4)
staym <- lm(y~stay*., df4)
maritalm <- lm(y~marital*., df4)
religionm <- lm(y~religion*., df4)
slval4m <- lm(y~SLval4*., df4)
slcom4m <- lm(y~SLcom4*., df4)
sla_idm <- lm(y~sla_id*., df4)
single_var_int<-data.frame(full_without_int=summary(fm)$adj.r.squared, gender=summary(genderm)$adj.r.squared, age=summary(agem)$adj.r.squared, degree=summary(degreem)$adj.r.squared, stay=summary(staym)$adj.r.squared, marital=summary(maritalm)$adj.r.squared, religion=summary(religionm)$adj.r.squared, SLval4=summary(slval4m)$adj.r.squared, SLcom4=summary(slcom4m)$adj.r.squared, sla_id=summary(sla_idm)$adj.r.squared)
rownames(single_var_int) <- "adj_r_squared"
single_var_int
fmint2 <- lm(y~stay*. + degree*. + SLval4*. + sla_id*., df4)
summary(fmint2)
fmint2step <- step(fmint2)
summary(fmint2step)
# SLval4 interaction introduce alias columns
fmint3 <- lm(y~stay*. + degree*. + sla_id*., df4)
summary(fmint3)
fmint3step <- step(fmint3)
summary(fmint3step)
#SLcom4 is introducing alias columns and itself is not almost independent of our y
df6 <- df4[,-9]
fmint4 <- lm(y~stay*. + degree*. + sla_id*., df6)
summary(fmint4)
fmint4step <- step(fmint4)
summary(fmint4step)
mstay <- lm(y~. + stay:., df6)
summary(mstay)
mstaystep <- step(mstay)
summary(mstay)
mdg <- lm(y~. + degree:., df6)
summary(mdg)
mdgstep <- step(mdg)
summary(mdgstep)
mid <- lm(y~. + sla_id:., df6)
summary(mid)
midstep <- step(mid)
summary(midstep)
mval <- lm(y~. + SLval4:., df6)
summary(mval)
mvalstep <- step(mval)
summary(mvalstep)
m_dg <- lm(y~. + stay:. + sla_id:. + SLval4:., df6)
summary(m_dg)
m_dgstep <- step(m_dg)
summary(m_dgstep)
m_stay <- lm(y~. + degree:. + sla_id:. + SLval4:., df6)
summary(m_stay)
m_staystep <- step(m_stay)
summary(m_staystep)
m_id <- lm(y~. + degree:. + stay:. + SLval4:., df6)
summary(m_id)
m_idstep <- step(m_id)
summary(m_idstep)
m_val <- lm(y~. + degree:. + stay:. + sla_id:., df6)
summary(m_val)
m_valstep <- step(m_val)
summary(m_valstep)
## with 2
m1 <- lm(y~. + degree:. + stay:., df6)
summary(m1)
m1step <- step(m1)
summary(m1step)
m2 <- lm(y~. + degree:. + sla_id:., df6)
summary(m2)
m2step <- step(m2)
summary(m2step)
m3 <- lm(y~. + degree:. + SLval4:., df6)
summary(m3)
m3step <- step(m3)
summary(m3step)
m4 <- lm(y~. + SLval4:. + stay:., df6)
summary(m4)
m4step <- step(m4)
summary(m4step)
m5 <- lm(y~. + sla_id:. + stay:., df6)
summary(m5)
m5step <- step(m5)
summary(m5step)
m6 <- lm(y~. + sla_id:. + SLval4:., df6)
summary(m6)
m6step <- step(m6)
summary(m6step)
aic <- AIC(fmstep, fmintstep, fmint2step, fmint3step, fmint4step, mstaystep, mdgstep, midstep, mvalstep, m_staystep, m_dgstep, m_idstep, m_valstep, m1step, m2step, m3step, m4step, m5step, m6step)
bic <- BIC(fmstep, fmintstep, fmint2step, fmint3step, fmint4step, mstaystep, mdgstep, midstep, mvalstep, m_staystep, m_dgstep, m_idstep, m_valstep, m1step, m2step, m3step, m4step, m5step, m6step)
compare <- cbind(aic, bic$BIC)
compare$adj.rsqr <- rep(0, nrow(bic))
compare$adj.rsqr[1] <- summary(fmstep)$adj.r.squared
compare$adj.rsqr[2] <- summary(fmintstep)$adj.r.squared
compare$adj.rsqr[3] <- summary(fmint2step)$adj.r.squared
compare$adj.rsqr[4] <- summary(fmint3step)$adj.r.squared
compare$adj.rsqr[5] <- summary(fmint4step)$adj.r.squared
compare$adj.rsqr[6] <- summary(mstaystep)$adj.r.squared
compare$adj.rsqr[7] <- summary(mdgstep)$adj.r.squared
compare$adj.rsqr[8] <- summary(midstep)$adj.r.squared
compare$adj.rsqr[9] <- summary(mvalstep)$adj.r.squared
compare$adj.rsqr[10] <- summary(m_staystep)$adj.r.squared
compare$adj.rsqr[11] <- summary(m_dgstep)$adj.r.squared
compare$adj.rsqr[12] <- summary(m_idstep)$adj.r.squared
compare$adj.rsqr[13] <- summary(m_valstep)$adj.r.squared
compare$adj.rsqr[14] <- summary(m1step)$adj.r.squared
compare$adj.rsqr[15] <- summary(m2step)$adj.r.squared
compare$adj.rsqr[16] <- summary(m3step)$adj.r.squared
compare$adj.rsqr[17] <- summary(m4step)$adj.r.squared
compare$adj.rsqr[18] <- summary(m5step)$adj.r.squared
compare$adj.rsqr[19] <- summary(m6step)$adj.r.squared
compare[order(compare$df),]
sl1 <- lm(y~. + sla_id:degree + stay:SLval4 + degree:age + SLval4:marital + stay:sla_id + age:stay + age:sla_id, df4)
summary(sl1)
sl1step<-step(sl1)
summary(sl1step)
compare <- rbind(compare, c(21,AIC(sl1step), BIC(sl1step), summary(sl1step)$adj.r.squared))
rownames(compare)[20] <- "sl1step"
View(compare)
compare <- cbind(aic, bic$BIC)
compare$adj.rsqr <- rep(0, nrow(bic))
compare$adj.rsqr[1] <- summary(fmstep)$adj.r.squared
compare$adj.rsqr[2] <- summary(fmintstep)$adj.r.squared
compare$adj.rsqr[3] <- summary(fmint2step)$adj.r.squared
compare$adj.rsqr[4] <- summary(fmint3step)$adj.r.squared
compare$adj.rsqr[5] <- summary(fmint4step)$adj.r.squared
compare$adj.rsqr[6] <- summary(mstaystep)$adj.r.squared
compare$adj.rsqr[7] <- summary(mdgstep)$adj.r.squared
compare$adj.rsqr[8] <- summary(midstep)$adj.r.squared
compare$adj.rsqr[9] <- summary(mvalstep)$adj.r.squared
compare$adj.rsqr[10] <- summary(m_staystep)$adj.r.squared
compare$adj.rsqr[11] <- summary(m_dgstep)$adj.r.squared
compare$adj.rsqr[12] <- summary(m_idstep)$adj.r.squared
compare$adj.rsqr[13] <- summary(m_valstep)$adj.r.squared
compare$adj.rsqr[14] <- summary(m1step)$adj.r.squared
compare$adj.rsqr[15] <- summary(m2step)$adj.r.squared
compare$adj.rsqr[16] <- summary(m3step)$adj.r.squared
compare$adj.rsqr[17] <- summary(m4step)$adj.r.squared
compare$adj.rsqr[18] <- summary(m5step)$adj.r.squared
compare$adj.rsqr[19] <- summary(m6step)$adj.r.squared
compare[order(compare$df),]
View(compare)
compare <- rbind(compare, c(21,AIC(sl1step), BIC(sl1step), summary(sl1step)$adj.r.squared))
View(compare)
rownames(compare)[20] <- "sl1step"
View(compare)
?step
sl2step <- step(sl1step, scope=list(sl1step, fmint$call), direction="forward")
summary(sl2step)
summary(sl1step)
sl2step <- step(sl1step, scope=list(sl1step$call, fmint$call), direction="forward")
summary(sl2step)
sl2step <- step(sl1step, scope=fmint$call, direction="forward")
summary(sl2step)
sl1step$call
sl2step$call
sl2step <- step(sl1step, direction="forward")
sl2step$call
sl2step <- step(sl1step, scope=fmint$call, direction="forward")
sl2step$call
lm(y~.*., df6)$call
sl2step <- step(sl1step, lm(y~.*., df6)$call, direction="forward")
sl2step$call
summary(sl2step)
compare <- rbind(compare, c(33,AIC(sl2step), BIC(sl2step), summary(sl2step)$adj.r.squared))
rownames(compare)[15] <- "sl2step"
View(compare)
compare <- cbind(aic, bic$BIC)
compare$adj.rsqr <- rep(0, nrow(bic))
compare$adj.rsqr[1] <- summary(fmstep)$adj.r.squared
compare$adj.rsqr[2] <- summary(fmintstep)$adj.r.squared
compare$adj.rsqr[3] <- summary(fmint2step)$adj.r.squared
compare$adj.rsqr[4] <- summary(fmint3step)$adj.r.squared
compare$adj.rsqr[5] <- summary(fmint4step)$adj.r.squared
compare$adj.rsqr[6] <- summary(mstaystep)$adj.r.squared
compare$adj.rsqr[7] <- summary(mdgstep)$adj.r.squared
compare$adj.rsqr[8] <- summary(midstep)$adj.r.squared
compare$adj.rsqr[9] <- summary(mvalstep)$adj.r.squared
compare$adj.rsqr[10] <- summary(m_staystep)$adj.r.squared
compare$adj.rsqr[11] <- summary(m_dgstep)$adj.r.squared
compare$adj.rsqr[12] <- summary(m_idstep)$adj.r.squared
compare$adj.rsqr[13] <- summary(m_valstep)$adj.r.squared
compare$adj.rsqr[14] <- summary(m1step)$adj.r.squared
compare$adj.rsqr[15] <- summary(m2step)$adj.r.squared
compare$adj.rsqr[16] <- summary(m3step)$adj.r.squared
compare$adj.rsqr[17] <- summary(m4step)$adj.r.squared
compare$adj.rsqr[18] <- summary(m5step)$adj.r.squared
compare$adj.rsqr[19] <- summary(m6step)$adj.r.squared
compare <- rbind(compare, c(21,AIC(sl1step), BIC(sl1step), summary(sl1step)$adj.r.squared))
rownames(compare)[20] <- "sl1step"
compare <- cbind(aic, bic$BIC)
compare$adj.rsqr <- rep(0, nrow(bic))
compare$adj.rsqr[1] <- summary(fmstep)$adj.r.squared
compare$adj.rsqr[2] <- summary(fmintstep)$adj.r.squared
compare$adj.rsqr[3] <- summary(fmint2step)$adj.r.squared
compare$adj.rsqr[4] <- summary(fmint3step)$adj.r.squared
compare$adj.rsqr[5] <- summary(fmint4step)$adj.r.squared
compare$adj.rsqr[6] <- summary(mstaystep)$adj.r.squared
compare$adj.rsqr[7] <- summary(mdgstep)$adj.r.squared
compare$adj.rsqr[8] <- summary(midstep)$adj.r.squared
compare$adj.rsqr[9] <- summary(mvalstep)$adj.r.squared
compare$adj.rsqr[10] <- summary(m_staystep)$adj.r.squared
compare$adj.rsqr[11] <- summary(m_dgstep)$adj.r.squared
compare$adj.rsqr[12] <- summary(m_idstep)$adj.r.squared
compare$adj.rsqr[13] <- summary(m_valstep)$adj.r.squared
compare$adj.rsqr[14] <- summary(m1step)$adj.r.squared
compare$adj.rsqr[15] <- summary(m2step)$adj.r.squared
compare$adj.rsqr[16] <- summary(m3step)$adj.r.squared
compare$adj.rsqr[17] <- summary(m4step)$adj.r.squared
compare$adj.rsqr[18] <- summary(m5step)$adj.r.squared
compare$adj.rsqr[19] <- summary(m6step)$adj.r.squared
compare <- rbind(compare, c(21,AIC(sl1step), BIC(sl1step), summary(sl1step)$adj.r.squared))
rownames(compare)[20] <- "sl1step"
compare <- rbind(compare, c(33,AIC(sl2step), BIC(sl2step), summary(sl2step)$adj.r.squared))
rownames(compare)[21] <- "sl2step"
alias(sl2step)
summary(sl2step)
sl3 <- lm(y ~ gender + age + degree + stay + SLval4 + sla_id + degree:sla_id + stay:SLval4 + age:degree + stay:sla_id + age:sla_id + gender:SLval4 + age:marital + degree:marital + marital:SLval4 + degree:stay + age:degree:sla_id, df4)
summary(sl3)
View(compare)
compare <- rbind(compare, c(33,AIC(sl3), BIC(sl3), summary(sl3)$adj.r.squared))
rownames(compare)[22] <- "sl3"
View(compare)
sl4 <- lm(y ~ gender + age + degree + stay + SLval4 + sla_id + degree:sla_id + stay:SLval4 + age:degree + stay:sla_id + age:sla_id + gender:SLval4 + age:marital + degree:marital + marital:SLval4 + degree:stay, df4)
summary(sl4)
compare <- rbind(compare, c(31 ,AIC(sl4), BIC(sl4), summary(sl4)$adj.r.squared))
rownames(compare)[14] <- "sl4"
View(compare)
rownames(compare)[24] <- "sl4"
View(compare)
rownames(compare)[23] <- "sl4"
View(compare)
compare <- cbind(aic, bic$BIC)
compare$adj.rsqr <- rep(0, nrow(bic))
compare$adj.rsqr[1] <- summary(fmstep)$adj.r.squared
compare$adj.rsqr[2] <- summary(fmintstep)$adj.r.squared
compare$adj.rsqr[3] <- summary(fmint2step)$adj.r.squared
compare$adj.rsqr[4] <- summary(fmint3step)$adj.r.squared
compare$adj.rsqr[5] <- summary(fmint4step)$adj.r.squared
compare$adj.rsqr[6] <- summary(mstaystep)$adj.r.squared
compare$adj.rsqr[7] <- summary(mdgstep)$adj.r.squared
compare$adj.rsqr[8] <- summary(midstep)$adj.r.squared
compare$adj.rsqr[9] <- summary(mvalstep)$adj.r.squared
compare$adj.rsqr[10] <- summary(m_staystep)$adj.r.squared
compare$adj.rsqr[11] <- summary(m_dgstep)$adj.r.squared
compare$adj.rsqr[12] <- summary(m_idstep)$adj.r.squared
compare$adj.rsqr[13] <- summary(m_valstep)$adj.r.squared
compare$adj.rsqr[14] <- summary(m1step)$adj.r.squared
compare$adj.rsqr[15] <- summary(m2step)$adj.r.squared
compare$adj.rsqr[16] <- summary(m3step)$adj.r.squared
compare$adj.rsqr[17] <- summary(m4step)$adj.r.squared
compare$adj.rsqr[18] <- summary(m5step)$adj.r.squared
compare$adj.rsqr[19] <- summary(m6step)$adj.r.squared
sl1 <- lm(y~. + sla_id:degree + stay:SLval4 + degree:age + SLval4:marital + stay:sla_id + age:stay + age:sla_id, df4)
summary(sl1)
sl1step<-step(sl1)
summary(sl1step)
compare <- rbind(compare, c(21,AIC(sl1step), BIC(sl1step), summary(sl1step)$adj.r.squared))
rownames(compare)[20] <- "sl1step"
sl2step <- step(sl1step, lm(y~.*., df6)$call, direction="forward")
summary(sl2step)
compare <- rbind(compare, c(33,AIC(sl2step), BIC(sl2step), summary(sl2step)$adj.r.squared))
rownames(compare)[21] <- "sl2step"
sl3 <- lm(y ~ gender + age + degree + stay + SLval4 + sla_id + degree:sla_id + stay:SLval4 + age:degree + stay:sla_id + age:sla_id + gender:SLval4 + age:marital + degree:marital + marital:SLval4 + degree:stay + age:degree:sla_id, df4)
summary(sl3)
compare <- rbind(compare, c(33,AIC(sl3), BIC(sl3), summary(sl3)$adj.r.squared))
rownames(compare)[22] <- "sl3"
sl4 <- lm(y ~ gender + age + degree + stay + SLval4 + sla_id + degree:sla_id + stay:SLval4 + age:degree + stay:sla_id + age:sla_id + gender:SLval4 + age:marital + degree:marital + marital:SLval4 + degree:stay, df4)
summary(sl4)
compare <- rbind(compare, c(31 ,AIC(sl4), BIC(sl4), summary(sl4)$adj.r.squared))
rownames(compare)[23] <- "sl4"
View(compare)
